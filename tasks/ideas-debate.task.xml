<task id="bmad/sew/tasks/ideas-debate.task.xml" name="Ideas Debate">
  <objective>Äiá»u hÃ nh má»™t cuá»™c tranh luáº­n giá»¯a cÃ¡c agent chuyÃªn gia Ä‘á»ƒ Æ°u tiÃªn hÃ³a cÃ¡c Ã½ tÆ°á»Ÿng cho bÃ i viáº¿t má»›i vá»›i full logging tá»«ng round.</objective>

  <parameters>
    <param name="topic" type="string" required="true">Chá»§ Ä‘á» chÃ­nh cá»§a cuá»™c tranh luáº­n (vÃ­ dá»¥: "CÃ¡c Ã½ tÆ°á»Ÿng cho bÃ i viáº¿t má»›i").</param>
    <param name="ideas_list" type="array" required="true">Danh sÃ¡ch cÃ¡c ideas cáº§n debate vÃ  xáº¿p háº¡ng.</param>
    <param name="content_analysis_report" type="string" required="true">BÃ¡o cÃ¡o phÃ¢n tÃ­ch ná»™i dung tá»« ContentAnalyzer.</param>
    <param name="market_insight_report" type="string" required="true">BÃ¡o cÃ¡o insight thá»‹ trÆ°á»ng tá»« MarketInsightAgent.</param>
    <param name="seo_preliminary_analysis" type="string" required="false">PhÃ¢n tÃ­ch SEO sÆ¡ bá»™ tá»« SEOSpecialist (náº¿u cÃ³).</param>
    <param name="cultural_context" type="string" required="false">Ngá»¯ cáº£nh vÄƒn hÃ³a tá»« cÃ¡c tá»‡p há»— trá»£.</param>
    <param name="num_rounds" type="number" required="false">Sá»‘ rounds tranh luáº­n (máº·c Ä‘á»‹nh: 2).</param>
    <param name="output_file" type="string" required="false">ÄÆ°á»ng dáº«n file Ä‘á»ƒ lÆ°u full debate transcript (YAML).</param>
  </parameters>

  <output>
    <param name="debate_transcript" type="yaml">Full debate transcript vá»›i táº¥t cáº£ rounds vÃ  exchanges.</param>
    <param name="ranked_ideas" type="array">Ideas Ä‘Ã£ Ä‘Æ°á»£c xáº¿p háº¡ng theo Ä‘iá»ƒm sá»‘.</param>
    <param name="synthesis" type="object">Tá»•ng há»£p insights tá»« debate.</param>
  </output>

  <flow>
    <step n="1" goal="Chuáº©n bá»‹ context data vÃ  ideas">
      <action>Combine all context reports into one context_data string:
        ```
        === Content Analysis ===
        {{content_analysis_report}}

        === Market Insights ===
        {{market_insight_report}}

        === SEO Analysis ===
        {{seo_preliminary_analysis}}

        === Cultural Context ===
        {{cultural_context}}
        ```
      </action>

      <action>Set default {{num_rounds}} = 3 if not provided</action>

      <action>Validate {{ideas_list}}:
        - Must have at least 3 ideas to debate
        - Each idea should have: id, title, description
      </action>

      <action>Log initiation:
        "ğŸ¯ Starting Ideas Debate"
        "ğŸ“‹ Topic: {{topic}}"
        "ğŸ’¡ Ideas to debate: {{ideas_list.length}}"
        "ğŸ”„ Rounds planned: {{num_rounds}}"
      </action>
    </step>

    <step n="2" goal="Invoke debate orchestrator">
      <action critical="true">
        Execute debate-orchestrator.task.xml vá»›i parameters Ä‘áº§y Ä‘á»§:
        ```
        exec: {project-root}/bmad/sew/tasks/debate-orchestrator.task.xml
        parameters:
          topic: {{topic}}
          debaters: ["ContentAnalyzer", "MarketInsightAgent", "SEOSpecialist", "AdaptiveWriter"]
          scoring_criteria: ["SEO Performance", "Cultural Resonance", "Engagement Potential", "Strategic Alignment"]
          context_data: {{combined_context}}
          ideas_to_debate: {{ideas_list}}
          num_rounds: {{num_rounds}}
          output_file: {{output_file}}
        output_variable: orchestrator_results
        ```
      </action>

      <note>Orchestrator handles:
        - All debate rounds with full exchanges
        - Agent-to-agent dialogue
        - Evidence-based scoring
        - Synthesis of insights
        - YAML output with complete transcript
      </note>
    </step>

    <step n="3" goal="Extract and present results">
      <action>Extract from orchestrator_results:
        - debate_transcript (full YAML)
        - ranked_ideas (sorted by score)
        - synthesis (key insights)
      </action>

      <action>Display summary to user:
        "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        "âœ… IDEAS DEBATE COMPLETE"
        "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        ""
        "ğŸ† Top Ranked Ideas:"
        For each idea in ranked_ideas (top 3):
          "{{rank}}. {{title}}"
          "   Score: {{total_score}}/{{max}} ({{percentage}}%)"
          "   Consensus: {{consensus_level}}"
          "   Key Strength: {{top_strength}}"
        ""
        "ğŸ’¡ Key Insights:"
        For each insight in synthesis.key_insights:
          "- {{insight}}"
        ""
        IF output_file:
          "ğŸ“„ Full transcript saved: {{output_file}}"
      </action>
    </step>

    <step n="4" goal="Return structured output">
      <output>
        <param name="debate_transcript" type="yaml">{{orchestrator_results.debate_transcript}}</param>
        <param name="ranked_ideas" type="array">{{orchestrator_results.ranked_ideas}}</param>
        <param name="synthesis" type="object">{{orchestrator_results.synthesis}}</param>
      </output>
    </step>
  </flow>

  <notes>
    <note>This task now uses debate-orchestrator.task.xml infrastructure</note>
    <note>Full debate details are captured in YAML transcript</note>
    <note>All agent exchanges, rebuttals, and cross-references are logged</note>
    <note>Scoring is evidence-based with agent attribution</note>
    <note>Output is compatible with human approval gates in workflow</note>
  </notes>
</task>
